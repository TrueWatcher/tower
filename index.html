<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<!--
This is a free software by TrueWatcher https://github.com/TrueWatcher/tower/tree/webmapviewer_exp
1.12.4 09.01.2021 fixed OpenTopoMap http > https
1.12.5 03.11.2023 fixed webMaps/leafletjs.html self-test, updated the leaflet library to 1.9
1.13.0 03.11.2023 experiments with leaflet-polycolor
1.13.1 04.11.2023 improved polycolor
1.14.0 20.11.2023 workable signalrack parsing and view
1.15.0 25.11.2023 added querying point at map center
1.15.1 28.11.2023 added reading signal data as json
1.16.0 28.11.2023 refactoring; added Zmanager for signal-specific stuff
1.16.1 30.11.2023 added zScaleSelect; rollback before reloading latest file
1.16.2 02.12.2023 improved Point
1.16.3 03.12.2023 fixed z-scaling over several tracks
1.17.0 05.11.2023 added painting by cell id
1.17.1 08.12.2023 cleanup Zmznager, README.md
1.17.2 30.03.2024 minor fixes with JShint
-->
<head>
  <title>View GPX and CSV tracks and waypoints over online maps</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <style>
    body { margin: 0; width: 99%; background-color: #ddd; }

    #wmIframe { width: 100%; height: 90%; margin: 0; }

    #panelTable * { font-family: Arial,sans-serif; font-size: 1em; margin: 0; padding: 0.05em; }

    #panelTable { width: 98%; text-align: center; }

    #alertTd { text-align: left; }
  </style>
</head>

<body>
  <div id="panelTable">
    <p id="alertTd">Loading...</p>
    <p>
      <input type="hidden" id="formHasDataInp" value="" />
      <input type="file" id="fileInput" name="fileInput" title="choose files to load" multiple />
      <label for="resizeInput" title="rescale the map to fit all data">resize</label>
      <input type="checkbox" id="resizeInput" name="resizeInput" checked />
      &nbsp;&nbsp;&nbsp;
      <button id="backBtn" title="dismiss the latest file" disabled >Back</button>
      &nbsp;&nbsp;&nbsp;
      <select id="providerSelect" name="providerSelect" title="map service">
        <option value="osm map" selected>OpenStreetMap</option>
        <option value="opentopo map">OpenTopoMap</option>
        <option value="google hyb">Google hybrid</option>
        <option value="google sat">Google sat</option>
        <!--<option value="marshruty.ru map">marshruty.ru</option>-->
        <option value="blank map">blank</option>
        <option value="yandex hyb">Yandex hybrid</option>
      </select>
      &nbsp;&nbsp;&nbsp;
      <button id="getDataBtn" title="get point at map center">Point</button>
      &nbsp;&nbsp;&nbsp;
      <select id="zscaleSelect" name="zscaleSelect" title="Z scale" style="display: none;">
        <option value="auto" selected>auto</option>
        <option value="static -130 -30">-130 -30</option>
        <option value="static -125 -85">-125 -85</option>
        <option value="cell CID">cell CID</option>
        <option value="cell PCI">cell PCI</option>
      </select>
    </p>
  </div>

  <iframe id="wmIframe" src="webMaps/wallpaper.html"></iframe>

  <script src="webMaps/utils.js"></script>
  <script src="fileBox/Parser.js"></script>
  <script src="fileBox/MyJSbridge.js"></script>
  <script src="fileBox/View.js"></script>
  <script src="fileBox/Zmanager.js"></script>
  <script src="fileBox/controller.js"></script>
  <script>
    // handle reload correctly
    if ($("formHasDataInp").value) $("wmIframe").src="webMaps/wallpaper.html";
    else $("formHasDataInp").value="yes";

    var JSbridge;
    var v=new wm.fb.View();
    v.adjust();
    var c=new wm.fb.Controller(v);
    v.setHandlers(c.addFiles, c.reloadMap, c.stepBack);
    v.setHandlers2(c.getDataForCenter, c.updateSignalTrackColors);
  </script>
</body>
</html>
